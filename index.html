<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Flexport Fall Release 25 Timer</title>

  <!-- Preload Font -->
  <link rel="preload" href="Fonts/Antenna-Medium.woff2" as="font" type="font/woff2" crossorigin>

  <style>
    @font-face {
      font-family: 'AntennaMedium';
      src: url('Fonts/Antenna-Medium.woff2') format('woff2'),
           url('Fonts/Antenna-Medium.woff') format('woff');
      font-weight: 500;
      font-style: normal;
      font-display: swap;
    }

    body {
      margin: 0;
      width: 100vw;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background: #000;
      overflow: hidden;
      flex-direction: column;
    }

    .timer-container {
      width: 3520px;
      height: 1056px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
    }

    #logo {
      width: 100%;     
      max-width: 1200px;
      height: auto;
      margin-bottom: 40px;
    }

    #timer {
      font-family: 'AntennaMedium', sans-serif;
      font-size: 200px;
      letter-spacing: 8px;
      color: #fff;
      max-width: 1200px;
    }

    #finalCountdown {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      background: #000;
      font-family: 'AntennaMedium', sans-serif;
      font-size: 600px; /* Slightly smaller */
      color: transparent;
      background: linear-gradient(180deg, #028DAC 44%, #FFFFFF 100%);
      -webkit-background-clip: text;
      background-clip: text;
      opacity: 0;
      pointer-events: none;
      z-index: 1000;
      animation: none;
    }

    @keyframes numberPulse {
      0%   { transform: scale(0.8); opacity: 0; }
      20%  { transform: scale(1);   opacity: 1; }
      80%  { transform: scale(1.1); opacity: 0; }
      100% { transform: scale(1.1); opacity: 0; }
    }

    @keyframes fadeToBlack {
      0% { background-color: #000; opacity: 1; }
      100% { background-color: #000; opacity: 0; }
    }
  </style>
</head>
<body>
  <div class="timer-container" id="mainContent">
    <img id="logo" src="Images/Flexport_FallRelease25_Logo.svg" alt="Flexport Fall Release 25 Logo">
    <div id="timer">00:10:00</div>
  </div>

  <div id="finalCountdown"></div>

  <script>
    let params = new URLSearchParams(window.location.search);

    // Exact parsing of hours/minutes/seconds
    let hours   = params.has("hours")   ? parseInt(params.get("hours"))   || 0 : 0;
    let minutes = params.has("minutes") ? parseInt(params.get("minutes")) || 0 : 0;
    let seconds = params.has("seconds") ? parseInt(params.get("seconds")) || 0 : 0;

    // Default to 10 minutes if nothing specified
    if (!params.has("hours") && !params.has("minutes") && !params.has("seconds")) {
      minutes = 10;
    }

    let autoStart = params.get("autostart") === "true";

    let duration = hours * 3600 + minutes * 60 + seconds;
    let timeRemaining = duration;
    let timerInterval = null;

    const timerDisplay = document.getElementById('timer');
    const mainContent = document.getElementById('mainContent');
    const finalCountdown = document.getElementById('finalCountdown');

    function updateDisplay() {
      let mins = Math.floor(timeRemaining / 60);
      let secs = timeRemaining % 60;
      let hrs = Math.floor(mins / 60);
      mins = mins % 60;

      timerDisplay.textContent =
        String(hrs).padStart(2, '0') + ":" +
        String(mins).padStart(2, '0') + ":" +
        String(secs).padStart(2, '0');
    }

    function startTimer() {
      if (timerInterval) return;
      timerInterval = setInterval(() => {
        if (timeRemaining > 0) {
          timeRemaining--;
          updateDisplay();

          // Start fullscreen countdown at exactly 10
          if (timeRemaining === 10) {
            clearInterval(timerInterval);
            timerInterval = null;
            startFinalCountdown();
          }
        }
      }, 1000);
    }

    function pauseTimer() {
      clearInterval(timerInterval);
      timerInterval = null;
    }

    function resetTimer() {
      pauseTimer();
      timeRemaining = duration;
      updateDisplay();
    }

    function startFinalCountdown() {
      mainContent.style.display = "none";

      let count = 10;
      let countdownInterval = setInterval(() => {
        if (count > 0) {
          finalCountdown.textContent = count;
          finalCountdown.style.opacity = "1";
          finalCountdown.style.animation = "none";
          void finalCountdown.offsetWidth; // reflow to restart animation
          finalCountdown.style.animation = "numberPulse 1s forwards";
          count--;
        } else {
          clearInterval(countdownInterval);
          finalCountdown.textContent = "";
          finalCountdown.style.animation = "fadeToBlack 2s forwards";
        }
      }, 1000);
    }

    document.addEventListener("keydown", (e) => {
      if (e.key === "s" || e.key === "S") startTimer();
      if (e.key === "p" || e.key === "P") pauseTimer();
      if (e.key === "r" || e.key === "R") resetTimer();
    });

    updateDisplay();
    if (autoStart) startTimer();
  </script>
</body>
</html>
